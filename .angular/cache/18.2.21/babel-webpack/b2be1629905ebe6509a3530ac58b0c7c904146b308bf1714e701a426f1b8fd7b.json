{"ast":null,"code":"import { BaseChartDirective } from 'ng2-charts';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../sensors.service\";\nimport * as i2 from \"@angular/forms\";\nimport * as i3 from \"ng2-charts\";\nexport let SensorCardComponent = /*#__PURE__*/(() => {\n  class SensorCardComponent {\n    constructor(sensorsService, el) {\n      this.sensorsService = sensorsService;\n      this.el = el;\n      this.history = [];\n      this.timeRange = 'day';\n      // lineChartOptions: ChartOptions<'line'> = {\n      //   responsive: true,\n      //   scales: {\n      //     x: { title: { display: true, text: 'Time' }},\n      //     y: { title: { display: true, text: 'Value' }}\n      //   }\n      // };\n      this.lineChartOptions = {\n        responsive: true,\n        plugins: {\n          legend: {\n            labels: {\n              color: '#fff'\n            }\n          }\n        },\n        scales: {\n          x: {\n            ticks: {\n              color: '#eee'\n            },\n            grid: {\n              color: '#333'\n            }\n          },\n          y: {\n            ticks: {\n              color: '#eee'\n            },\n            grid: {\n              color: '#333'\n            }\n          }\n        }\n      };\n    }\n    ngOnInit() {\n      this.loadHistory();\n    }\n    loadHistory() {\n      this.sensorsService.getSensorHistory(this.sensor.id, this.timeRange).subscribe({\n        next: data => {\n          this.history = data;\n          this.updateChart();\n        },\n        error: err => console.error('Failed to load history:', err)\n      });\n    }\n    changeTimeRange(range) {\n      this.timeRange = range;\n      this.loadHistory();\n    }\n    toggleFullscreen() {\n      const el = this.el.nativeElement;\n      if (!document.fullscreenElement) {\n        el.requestFullscreen().catch(err => console.error(err));\n      } else {\n        document.exitFullscreen();\n      }\n    }\n    updateChart() {\n      const labels = this.history.map(h => new Date(h.timestamp).toLocaleTimeString());\n      const data = this.history.map(h => h.value);\n      this.lineChartData = {\n        labels,\n        datasets: [{\n          data,\n          label: this.sensor.name,\n          borderColor: '#42A5F5',\n          fill: false,\n          tension: 0.3\n        }]\n      };\n      // Give chart a chance to resize inside the container\n      setTimeout(() => {\n        const chartEl = this.el.nativeElement.querySelector('canvas');\n        if (chartEl && chartEl.chart) {\n          chartEl.chart.update();\n        }\n      }, 50);\n    }\n    static {\n      this.ɵfac = function SensorCardComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || SensorCardComponent)(i0.ɵɵdirectiveInject(i1.SensorsService), i0.ɵɵdirectiveInject(i0.ElementRef));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: SensorCardComponent,\n        selectors: [[\"app-sensor-card\"]],\n        viewQuery: function SensorCardComponent_Query(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵviewQuery(BaseChartDirective, 5);\n          }\n          if (rf & 2) {\n            let _t;\n            i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chart = _t.first);\n          }\n        },\n        inputs: {\n          sensor: \"sensor\"\n        },\n        decls: 21,\n        vars: 6,\n        consts: [[1, \"sensor-card\"], [1, \"controls\"], [3, \"ngModelChange\", \"change\", \"ngModel\"], [\"value\", \"hour\"], [\"value\", \"day\"], [\"value\", \"week\"], [\"value\", \"month\"], [3, \"click\"], [\"baseChart\", \"\", \"chartType\", \"line\", 3, \"data\", \"options\"]],\n        template: function SensorCardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"h3\");\n            i0.ɵɵtext(2);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"p\");\n            i0.ɵɵtext(4);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"div\", 1)(6, \"label\");\n            i0.ɵɵtext(7, \"Range:\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"select\", 2);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function SensorCardComponent_Template_select_ngModelChange_8_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.timeRange, $event) || (ctx.timeRange = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"change\", function SensorCardComponent_Template_select_change_8_listener() {\n              return ctx.changeTimeRange(ctx.timeRange);\n            });\n            i0.ɵɵelementStart(9, \"option\", 3);\n            i0.ɵɵtext(10, \"Last Hour\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"option\", 4);\n            i0.ɵɵtext(12, \"Last Day\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(13, \"option\", 5);\n            i0.ɵɵtext(14, \"Last Week\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(15, \"option\", 6);\n            i0.ɵɵtext(16, \"Last Month\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(17, \"div\")(18, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function SensorCardComponent_Template_button_click_18_listener() {\n              return ctx.toggleFullscreen();\n            });\n            i0.ɵɵtext(19, \"\\uD83D\\uDD0D\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(20, \"canvas\", 8);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate(ctx.sensor.name);\n            i0.ɵɵadvance(2);\n            i0.ɵɵtextInterpolate2(\"Current Value: \", ctx.sensor.value, \" \", ctx.sensor.unit, \"\");\n            i0.ɵɵadvance(4);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.timeRange);\n            i0.ɵɵadvance(12);\n            i0.ɵɵproperty(\"data\", ctx.lineChartData)(\"options\", ctx.lineChartOptions);\n          }\n        },\n        dependencies: [i2.NgSelectOption, i2.ɵNgSelectMultipleOption, i2.SelectControlValueAccessor, i2.NgControlStatus, i2.NgModel, i3.BaseChartDirective],\n        styles: [\".sensor-card[_ngcontent-%COMP%]{height:100%;min-height:150px;background:#1e1e1ed9;padding:1rem;box-sizing:border-box;display:flex;flex-direction:column;justify-content:flex-start;box-shadow:0 8px 24px #0000004d;backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.05);overflow:hidden;transition:transform .2s,box-shadow .2s}.sensor-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;color:#7effa5}.sensor-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;margin-bottom:.5rem}.sensor-card[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.sensor-card[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:#323232e6;color:#fff;border-radius:8px;padding:.4rem;border:1px solid #555}.sensor-card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:#42a5f533;color:#42a5f5;border:1px solid #42A5F5;padding:.4rem .6rem}canvas[_ngcontent-%COMP%]{margin-top:.5rem}\"]\n      });\n    }\n  }\n  return SensorCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}