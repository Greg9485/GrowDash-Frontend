{"ast":null,"code":"import _asyncToGenerator from \"/Users/gregboydston/Documents/Projects/growdash-github-ready/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction DashboardComponent_div_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1, \"No readings yet.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction DashboardComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 11)(1, \"strong\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 12);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"div\", 13);\n    i0.ɵɵtext(6);\n    i0.ɵɵpipe(7, \"date\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const r_r1 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r1.type);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(r_r1.value);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(7, 3, r_r1.ts, \"short\"));\n  }\n}\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(http) {\n      this.http = http;\n      this.deviceId = 'esp32-1';\n      this.latest = [];\n      this.raw = 'no data';\n    }\n    sendIngest() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const payload = {\n          deviceId: _this.deviceId,\n          readings: {\n            temp: (20 + Math.random() * 8).toFixed(2),\n            rh: (40 + Math.random() * 20).toFixed(2)\n          }\n        };\n        const res = yield _this.http.post('/api/ingest/http', payload).toPromise();\n        _this.raw = JSON.stringify(res, null, 2);\n        yield _this.refresh();\n      })();\n    }\n    refresh() {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        const res = yield _this2.http.get(`/api/devices/${_this2.deviceId}/latest`).toPromise();\n        _this2.raw = JSON.stringify(res, null, 2);\n        _this2.latest = res.latest || [];\n      })();\n    }\n    static {\n      this.ɵfac = function DashboardComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || DashboardComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: DashboardComponent,\n        selectors: [[\"app-dashboard\"]],\n        decls: 27,\n        vars: 4,\n        consts: [[1, \"card\"], [2, \"display\", \"flex\", \"gap\", \"12px\", \"align-items\", \"flex-start\"], [2, \"flex\", \"1\"], [3, \"ngModelChange\", \"ngModel\"], [2, \"width\", \"140px\"], [3, \"click\"], [2, \"width\", \"160px\"], [1, \"grid\"], [\"style\", \"padding:12px\", 4, \"ngIf\"], [\"class\", \"sensor\", 4, \"ngFor\", \"ngForOf\"], [2, \"padding\", \"12px\"], [1, \"sensor\"], [2, \"font-size\", \"20px\", \"margin-top\", \"8px\"], [2, \"font-size\", \"11px\", \"color\", \"#666\", \"margin-top\", \"6px\"]],\n        template: function DashboardComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"label\");\n            i0.ɵɵtext(4, \"Device ID\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(5, \"input\", 3);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function DashboardComponent_Template_input_ngModelChange_5_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.deviceId, $event) || (ctx.deviceId = $event);\n              return $event;\n            });\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 4)(7, \"label\");\n            i0.ɵɵtext(8, \"\\u00A0\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(9, \"br\");\n            i0.ɵɵelementStart(10, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function DashboardComponent_Template_button_click_10_listener() {\n              return ctx.sendIngest();\n            });\n            i0.ɵɵtext(11, \"Send HTTP Ingest\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(12, \"div\", 6)(13, \"label\");\n            i0.ɵɵtext(14, \"\\u00A0\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelement(15, \"br\");\n            i0.ɵɵelementStart(16, \"button\", 5);\n            i0.ɵɵlistener(\"click\", function DashboardComponent_Template_button_click_16_listener() {\n              return ctx.refresh();\n            });\n            i0.ɵɵtext(17, \"Refresh Latest\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(18, \"h3\");\n            i0.ɵɵtext(19, \"Latest Readings\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"div\", 7);\n            i0.ɵɵtemplate(21, DashboardComponent_div_21_Template, 2, 0, \"div\", 8)(22, DashboardComponent_div_22_Template, 8, 6, \"div\", 9);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"h3\");\n            i0.ɵɵtext(24, \"Raw Response\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"pre\");\n            i0.ɵɵtext(26);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(5);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.deviceId);\n            i0.ɵɵadvance(16);\n            i0.ɵɵproperty(\"ngIf\", ctx.latest.length === 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngForOf\", ctx.latest);\n            i0.ɵɵadvance(4);\n            i0.ɵɵtextInterpolate(ctx.raw);\n          }\n        },\n        dependencies: [i2.NgForOf, i2.NgIf, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i2.DatePipe],\n        styles: [\".card[_ngcontent-%COMP%]{background:#fff;padding:16px;border-radius:10px;box-shadow:0 6px 18px #12121214}.grid[_ngcontent-%COMP%]{display:flex;gap:12px;flex-wrap:wrap}.sensor[_ngcontent-%COMP%]{flex:1 1 200px;padding:12px;border-radius:8px;border:1px solid #eee;background:#fff}\"]\n      });\n    }\n  }\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}